import pandas as pd
import numpy as np

import matplotlib.pyplot as plt

#importing the dataset from the url
df = "https://ontario.ca/v1/files/fuel-prices/pumppricesall.csv"
data = pd.read_csv(df)
#renaming the columns for better understanding
data.columns= ["Date", "Pump Price", "Crude Cost", "Federal Excise Tax", "Federal Carbon Tax", " Ontario Tax", "GST/HST", "Wholesale Margin", "Retail Margin", "Region"]
#counting the number of missing values
na_count = data.isna().sum()
print(na_count) #there are no missing values in the dataset


# Brief overview of Toronto data

toronto_data = data[data["Region"] == "Toronto"]
# Only using data with Toronto region and excluding the date and region columns
toronto_numeric_data = toronto_data.drop(columns=["Date", "Region"])
toronto_mean_values = toronto_numeric_data.mean()
toronto_min_values = toronto_numeric_data.min()
toronto_max_values = toronto_numeric_data.max()
toronto_first_quartile = toronto_numeric_data.quantile(0.25)
toronto_third_quartile = toronto_numeric_data.quantile(0.75)

print("Mean Values: \n", toronto_mean_values, "\n\n", "Min Values: \n", toronto_min_values, "\n\n", "Max Values: \n", toronto_max_values, "\n\n", "First Quartile: \n", toronto_first_quartile, "\n\n", "Third Quartile: \n", toronto_third_quartile)


# Brief descriptive statistics for Toronto data
print("Descriptive Statistics for Toronto Data:")
print(toronto_numeric_data.describe())
